---
layout: single
title: "LangFlow+ollamaå®ç°æœ¬åœ°RAGçŸ¥è¯†åº“"
sidebar:
  nav: "docs"
date: 2024-08-04 00:00:00 +0800
categories: [AI-Agents, Fine-Tuning, LLM, RAG]
tags: [AI, GPT, GPT-4, HuggingFace, LLM, LangChain, LangFlow, Ollama, RAG]
classes: wide
author_profile: true
---


#  LangFlow+ollamaå®ç°æœ¬åœ°RAGçŸ¥è¯†åº“ 

###  api key 

[ https://www.langflow.store/profile/api-key  ](<https://www.langflow.store/profile/api-key>)

###  huggingface 

[ LangFlow - a Hugging Face Space by Langflow  Discover amazing ML apps made by the community  ![Image](https://huggingface.co/favicon.ico) https://huggingface.co/spaces/Langflow/Langflow?duplicate=true  ![Image](https://cdn-thumbnails.huggingface.co/social-thumbnails/spaces/Langflow/Langflow.png) ](<https://huggingface.co/spaces/Langflow/Langflow?duplicate=true>)

LangFlow æ˜¯ä¸€ä¸ªå¼€æºçš„å¯è§†åŒ–æ¡†æ¶ï¼Œæ—¨åœ¨æ„å»ºå¤šæ™ºèƒ½ä½“å’Œæ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰åº”ç”¨ã€‚å®ƒæä¾›äº†ä¸€ä¸ªæ— éœ€ç¼–ç çš„ AI ç”Ÿæ€ç³»ç»Ÿï¼Œèƒ½å¤Ÿæ— ç¼é›†æˆå„ç§å¸¸ç”¨å·¥å…·å’ŒæŠ€æœ¯æ ˆã€‚LangFlow ä»¥ Python ä¸ºåŸºç¡€ï¼Œéå¸¸çµæ´»ï¼Œæ”¯æŒå¤šç§å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å’Œå‘é‡å­˜å‚¨ã€‚ 

###  LangFlow çš„ä¸»è¦ç‰¹ç‚¹ 

  1. **ç›´è§‚çš„å¯è§†åŒ–ç•Œé¢** : 
     * LangFlow æä¾›äº†ä¸€ä¸ªæ˜“äºä½¿ç”¨çš„å¯è§†åŒ–ç•Œé¢ï¼Œä½¿ç”¨æˆ·æ— éœ€ç¼–å†™å¤§é‡ä»£ç å°±èƒ½æ„å»ºå¤æ‚çš„ AI å·¥ä½œæµã€‚è¿™ä½¿å¾—æŠ€æœ¯å’ŒéæŠ€æœ¯ç”¨æˆ·éƒ½èƒ½è½»æ¾ä¸Šæ‰‹ã€‚ 


  2. **å¼ºå¤§çš„é›†æˆåŠŸèƒ½** : 
     * è¯¥å¹³å°æ”¯æŒä¸ä¼—å¤š AI å’Œæ•°æ®æœåŠ¡é›†æˆï¼Œå¦‚ OpenAIã€HuggingFaceã€LangChainã€Pinecone å’Œ Google Cloud ç­‰ã€‚è¿™ç§çµæ´»æ€§ä½¿ç”¨æˆ·èƒ½å¤Ÿå°†ä»–ä»¬çš„å·¥ä½œæµä¸å·²ç†Ÿæ‚‰çš„å·¥å…·å’ŒæœåŠ¡è¿æ¥èµ·æ¥ã€‚ 


  3. **å¤šç§å®‰è£…é€‰é¡¹** : 
     * LangFlow å¯ä»¥åœ¨æœ¬åœ°ã€Google Cloud æˆ– VirtualBox ç¯å¢ƒä¸­å®‰è£…ã€‚è¿™ç§å¤šæ ·æ€§ä½¿ç”¨æˆ·å¯ä»¥é€‰æ‹©æœ€é€‚åˆå…¶éœ€æ±‚å’Œèµ„æºçš„è®¾ç½®ã€‚ 


  4. **ç»„ä»¶åŒ–æ¶æ„** : 
     * è¯¥æ¡†æ¶é‡‡ç”¨ç»„ä»¶åŒ–çš„æ–¹æ³•ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ‹–æ”¾å„ç§å…ƒç´ ï¼ˆå¦‚æ¨¡å‹ã€æç¤ºå’Œæ•°æ®æºï¼‰æ¥åˆ›å»ºæ‰€éœ€çš„å·¥ä½œæµã€‚è¿™äº›ç»„ä»¶å¯ä»¥å®šåˆ¶å¹¶ä»¥ä¸åŒçš„æ–¹å¼è¿æ¥ï¼Œä»¥æ„å»ºå¤æ‚çš„ AI åº”ç”¨ã€‚ 


  5. **å¼‚æ­¥å¤„ç†** : 
     * LangFlow æ”¯æŒå¼‚æ­¥å¤„ç†ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°å¤„ç†é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ã€‚è¿™æ˜¯é€šè¿‡ä½¿ç”¨ Celery å·¥ä½œé˜Ÿåˆ—å’Œ AnyIO ä»»åŠ¡ç»„å®ç°çš„ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ç®€å•çš„ API è¿›è¡Œç®¡ç†ã€‚ 


  6. **åº”ç”¨åœºæ™¯** : 
     * LangFlow è¢«ç”¨äºå„ç§ AI åº”ç”¨ï¼ŒåŒ…æ‹¬èŠå¤©æœºå™¨äººã€æ–‡æ¡£é—®ç­”ç³»ç»Ÿå’Œè®°å¿†å‹èŠå¤©æœºå™¨äººã€‚å…¶çµæ´»æ€§å’Œæ˜“ç”¨æ€§ä½¿å…¶æˆä¸ºå¼€å‘è€…å¿«é€ŸåŸå‹å’Œéƒ¨ç½² AI è§£å†³æ–¹æ¡ˆçš„é¦–é€‰ã€‚ 


##  **ğŸ‘‰ğŸ‘‰ğŸ‘‰å¦‚æœ‰é—®é¢˜è¯·è”ç³»æˆ‘çš„å¾½ä¿¡ stoeng**

##  **ğŸ”¥ğŸ”¥ğŸ”¥æœ¬é¡¹ç›®ä»£ç ç”±AIè¶…å…ƒåŸŸé¢‘é“åˆ¶ä½œï¼Œè§‚çœ‹æ›´å¤šå¤§æ¨¡å‹å¾®è°ƒè§†é¢‘è¯·è®¿é—®æˆ‘çš„é¢‘é“â¬‡**

###  **ğŸ‘‰ğŸ‘‰ğŸ‘‰** **[ æˆ‘çš„å“”å“©å“”å“©é¢‘é“ ](<https://space.bilibili.com/3493277319825652>) **

###  **ğŸ‘‰ğŸ‘‰ğŸ‘‰** **[ æˆ‘çš„YouTubeé¢‘é“ ](<https://www.youtube.com/@AIsuperdomain>) **

###  **ğŸ‘‰ğŸ‘‰ğŸ‘‰æˆ‘çš„å¼€æºé¡¹ç›®** **[ https://github.com/win4r/AISuperDomain ](<https://github.com/win4r/AISuperDomain>) **

###  api key 

[ https://www.langflow.store/profile/api-key/ ](<https://www.langflow.store/profile/api-key/>)

###  å®‰è£… 

ç›´æ¥ä½¿ç”¨å·¥ä½œæµçš„api 
    
    
```
    curl -X POST \
        "http://127.0.0.1:7861/api/v1/run/ee207a8c-aa4f-435c-99e9-d4f019d4c92f?stream=false" \
        -H 'Content-Type: application/json'\
        -d '{"input_value": "message",
        "output_type": "chat",
        "input_type": "chat",
        "tweaks": {
      "ChatInput-u6JPw": {},
      "OllamaModel-Mb0Nf": {},
      "ChatOutput-wkFXt": {}
    }}'
```
        
    
    
```
    import argparse
    import json
    from argparse import RawTextHelpFormatter
    import requests
    from typing import Optional
    import warnings
    try:
        from langflow.load import upload_file
    except ImportError:
        warnings.warn("Langflow provides a function to help you upload files to the flow. Please install langflow to use it.")
        upload_file = None
```
    
```
    BASE_API_URL = "http://127.0.0.1:7861"
    FLOW_ID = "ee207a8c-aa4f-435c-99e9-d4f019d4c92f"
    ENDPOINT = "" # You can set a specific endpoint name in the flow settings
```
    
```
    # You can tweak the flow by adding a tweaks dictionary
    # e.g {"OpenAI-XXXXX": {"model_name": "gpt-4"}}
    TWEAKS = {
      "ChatInput-u6JPw": {},
      "OllamaModel-Mb0Nf": {},
      "ChatOutput-wkFXt": {}
    }
```
    
```
    def run_flow(message: str,
      endpoint: str,
      output_type: str = "chat",
      input_type: str = "chat",
      tweaks: Optional[dict] = None,
      api_key: Optional[str] = None) -> dict:
        """
        Run a flow with a given message and optional tweaks.
```
    
```
        :param message: The message to send to the flow
        :param endpoint: The ID or the endpoint name of the flow
        :param tweaks: Optional tweaks to customize the flow
        :return: The JSON response from the flow
        """
        api_url = f"{BASE_API_URL}/api/v1/run/{endpoint}"
```
    
```
        payload = {
            "input_value": message,
            "output_type": output_type,
            "input_type": input_type,
        }
        headers = None
        if tweaks:
            payload["tweaks"] = tweaks
        if api_key:
            headers = {"x-api-key": api_key}
        response = requests.post(api_url, json=payload, headers=headers)
        return response.json()
```
    
```
    def main():
        parser = argparse.ArgumentParser(description="""Run a flow with a given message and optional tweaks.
    Run it like: python <your file>.py "your message here" --endpoint "your_endpoint" --tweaks '{"key": "value"}'""",
            formatter_class=RawTextHelpFormatter)
        parser.add_argument("message", type=str, help="The message to send to the flow")
        parser.add_argument("--endpoint", type=str, default=ENDPOINT or FLOW_ID, help="The ID or the endpoint name of the flow")
        parser.add_argument("--tweaks", type=str, help="JSON string representing the tweaks to customize the flow", default=json.dumps(TWEAKS))
        parser.add_argument("--api_key", type=str, help="API key for authentication", default=None)
        parser.add_argument("--output_type", type=str, default="chat", help="The output type")
        parser.add_argument("--input_type", type=str, default="chat", help="The input type")
        parser.add_argument("--upload_file", type=str, help="Path to the file to upload", default=None)
        parser.add_argument("--components", type=str, help="Components to upload the file to", default=None)
```
    
```
        args = parser.parse_args()
        try:
          tweaks = json.loads(args.tweaks)
        except json.JSONDecodeError:
          raise ValueError("Invalid tweaks JSON string")
```
    
```
        if args.upload_file:
            if not upload_file:
                raise ImportError("Langflow is not installed. Please install it to use the upload_file function.")
            elif not args.components:
                raise ValueError("You need to provide the components to upload the file to.")
            tweaks = upload_file(file_path=args.upload_file, host=BASE_API_URL, flow_id=ENDPOINT, components=args.components, tweaks=tweaks)
```
    
```
        response = run_flow(
            message=args.message,
            endpoint=args.endpoint,
            output_type=args.output_type,
            input_type=args.input_type,
            tweaks=tweaks,
            api_key=args.api_key
        )
```
    
        print(json.dumps(response, indent=2))
    
    if __name__ == "__main__":
        main()
    

æ–¹æ³•1 
    
    
    python -m pip install langflow -U
    
    python -m langflow run
    

æ–¹æ³•2 
    
    
    git clone https://github.com/langflow-ai/langflow.git
    
    cd langflow
    
    make install_frontend && make build_frontend && make install_backend
    
    poetry run python -m langflow run
    

###  API 
    
    
    poetry run python -m langflow api-key
    
    
```
    curl -X POST \
      'http://localhost:7860/api/v1/run/4277d3c1-096d-48bc-a98a-8fc690ddaa8d' \
      -H 'Content-Type: application/json' \
      -H 'x-api-key: sk-mBZChEOy6Vc8n6MnCwVYNfiqbA3qoDYlR45-RrRhcnk' \
      -d '{"inputs": {"text": "hello"}, "tweaks": {}}'
```
    
    
    
```
    curl -X POST \
      'http://127.0.0.1:7861/api/v1/run/ee207a8c-aa4f-435c-99e9-d4f019d4c92f' \
      -H 'Content-Type: application/json' \
      -H 'x-api-key: sk-5vTph2sgyXxmqlgkfOqBxGo-ja2id4vrLdsrXa7LP4o' \
      -d '{"inputs": {"text": "hello"}, "tweaks": {}}'
```
    
    
    
    
    import requests
    from typing import Optional
    
```
    BASE_API_URL = "http://localhost:7860/api/v1/run"
    FLOW_ID = "4277d3c1-096d-48bc-a98a-8fc690ddaa8d"
    # You can tweak the flow by adding a tweaks dictionary
    # e.g {"OpenAI-XXXXX": {"model_name": "gpt-4"}}
    TWEAKS = {}
```
    
    
```
    def run_flow(inputs: dict,
                 flow_id: str,
                 tweaks: Optional[dict] = None,
                 apiKey: Optional[str] = None) -> dict:
        """
        Run a flow with given inputs and optional tweaks.
```
    
```
        :param inputs: The inputs to send to the flow
        :param flow_id: The ID of the flow to run
        :param tweaks: Optional tweaks to customize the flow
        :param apiKey: Optional API key for authentication
        :return: The JSON response from the flow
        """
        api_url = f"{BASE_API_URL}/{flow_id}"
        payload = {"inputs": inputs}
        headers = {"Content-Type": "application/json"}
```
    
```
        if tweaks:
            payload["tweaks"] = tweaks
        if apiKey:
            headers["x-api-key"] = apiKey
```
    
        response = requests.post(api_url, json=payload, headers=headers)
        return response.json()
    
    
```
    def extract_message(response: dict) -> str:
        """
        Extract the message text from the response.
```
    
```
        :param response: The JSON response from the flow
        :return: The extracted message text
        """
        try:
            return response['outputs'][0]['outputs'][0]['results']['message']['data']['text']
        except KeyError:
            return "Unable to extract the message from the response."
```
    
    
```
    # Setup inputs and API key
    inputs = {"input_value": "hello"}
    api_key = "sk-mBZChEOy6Vc8n6MnCwVYNfiqbA3qoDYlR45-RrRhcnk"
```
    
```
    # Run the flow and print the extracted message
    response = run_flow(inputs, flow_id=FLOW_ID, tweaks=TWEAKS, apiKey=api_key)
    print(extract_message(response))
```
    
